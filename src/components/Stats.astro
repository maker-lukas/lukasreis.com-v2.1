---

---
	
<p class="stats"><span class="time-display"></span><span class="now-playing-wrapper"><span class="sep">·</span><span class="now-playing">Loading</span></span><span class="sep">·</span><span class="coded-today">Loading</span> coded today!</p>

<style>
	.stats {
		font-size: 14px;
		color: var(--yellow);
		border-left: 3px solid var(--yellow);
		padding-left: 12px;
		margin-top: 20px;
	}

	.sep {
		font-size: 1.4em;
		margin: 0 6px;
		vertical-align: -0.1em;
	}

	:global(.now-playing a) {
		color: var(--yellow) !important;
	}
</style>

<script>

	function updateTime() {
		const now = new Date();
		const timeStr = now.toLocaleTimeString('en-GB', { 
			hour: '2-digit', 
			minute: '2-digit',
			timeZone: 'Europe/Lisbon'
		});
		
		document.querySelectorAll('.time-display').forEach(el => {
			el.textContent = timeStr;
		});
	}

	updateTime();
	setInterval(updateTime, 1000);

	async function updateNowPlaying() {
		try {
			const res = await fetch('/api/now-playing', { cache: 'no-store' });
			const data = await res.json();
			const el = document.querySelector('.now-playing');
			if (!el) return;

			if (data.error) {
				el.innerHTML = 'Not available';
			} else if (data.nowPlaying) {
				const wrapper = document.querySelector('.now-playing-wrapper') as HTMLElement | null;
				if (wrapper) wrapper.style.display = '';
				el.innerHTML = `<a href="${data.songUrl}" target="_blank">${data.song}</a> - <a href="${data.artistUrl}" target="_blank">${data.artist}</a>`;
			} else {
				const wrapper = document.querySelector('.now-playing-wrapper') as HTMLElement | null;
				if (wrapper) wrapper.style.display = 'none';
			}
		} catch {
			const el = document.querySelector('.now-playing');
		}
	}

	updateNowPlaying();
	setInterval(updateNowPlaying, 6000);

	async function codingStats() {
		try {
			const res = await fetch('/api/hackatime');
			const data = await res.json();
			const el = document.querySelector('.coded-today');
			if (!el) return;

			if (data.data?.human_readable_total) {
				el.textContent = data.data.human_readable_total.replace(/\s*\d+s/, '');
			} else {
				el.textContent = '0m';
			}
		} catch {
			const el = document.querySelector('.coded-today');
			if (el) el.textContent = '0m';
		}
	}

	codingStats();
	setInterval(codingStats, 5000);
	

</script>
